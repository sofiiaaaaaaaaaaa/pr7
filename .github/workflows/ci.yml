name: CI/CD Pipeline

on:
  push:
    branches: ["*", "*/*"]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: echo "Hello, $GITHUB_ACTOR!"

  test1:
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Test 1
        run: echo "simple test"

  test2:
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Test 2 slow
        run: |
          echo "long test"
          sleep 20

  test3:
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Test 3 integration
        run: |
          echo "integration test"
          sleep 10

  deploy:
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    needs: [test1, test2, test3]
    steps:
      - name: Deploy
        run: echo "Deploying..."
